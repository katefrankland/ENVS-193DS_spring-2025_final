---
title: "final"
format: html

#knitr::opts_chunk$set(fig.width = 10, fig.height = 5)

---
initial set up 
```{r}

install.packages("tidyverse")
install.packages("gt")
install.packages("janitor")
install.packages("here")
install.packages("lubridate")
install.packages("readxl")
install.packages("MuMIn")
install.packages("DHARMa")
install.packages("fs")


library(tidyverse)  

library(gt)

library(janitor)

library(here) 

library(lubridate) 

library(readxl)  

library(MuMIn) 

library(DHARMa) 

library(fs) 
```


Reading in Data 
```{r}
sst <- read.csv(here("data", "SST_update2023.csv")) # reading in data 

```


Problem 2 

(a) Cleaning and Summarizing Data 
```{r}
sst_clean <- sst |> #beginning the sst dataframe
  mutate (
    date = ymd(date), # making date an object 
    month = month(date, label = TRUE, abbr = TRUE) |> #creating a column for months
              factor(levels = month.abb, ordered = TRUE), #ordered factor for months 
    year = (year(date)) #creating a column for years 
    ) |> 
      
    filter(year >= 2018, year <= 2023) |> #filtering years to include 2018 - 2023 
    mutate(
      year = factor(year) #convert to factor 
    ) |> 
    group_by(year, month) |> # group data by the year and the month 
    summarize(mean_monthly_sst = mean(temp, na.rm = TRUE)) |> #summarize the mean monthly sst 
    ungroup() #remove grouping 

slice_sample(sst_clean, n = 5) # show 5 random rows 

str(sst_clean) # show structure of the data 


```


(b) Visualize the Data 
```{r, fig.height = 5, fig.width = 10 }

ggplot(data = sst_clean, #creating visualization, using sst_clean data frame
       aes(x = month, # month is the x axis 
           y = mean_monthly_sst, # meanly monthly sst is the y axis 
           group = year, # group data by year 
           color = year)) + #color data by year
  
  geom_line(linewidth = 0.5) + #adjusting line width 
  geom_point(size = 1.5) + # adjusting point size
  
  scale_color_manual(values = c( #color the lines different shades of blue
    "2018" = "paleturquoise",
    "2019" = "skyblue",
    "2020" = "steelblue",
    "2021" = "royalblue",
    "2022" = "blue3",
    "2023" = "blue4"  
  )) + 
```






